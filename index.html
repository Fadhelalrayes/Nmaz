<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>تعليم الصلاة وفق المذهب الجعفري</title>
  <meta name="description" content="منصّة أكاديمية تفاعلية لتعليم الصلاة وفق المذهب الجعفري، مع مصادر موثوقة من موقع مكتب السيد السيستاني، وتاريخ هجري/ميلادي ومواقيت الصلاة لتوقيت البحرين." />

  <!-- أمان أساسي لصفحة ثابتة على GitHub Pages -->
  <meta http-equiv="Content-Security-Policy"
        content="default-src 'self'; img-src 'self' data:; style-src 'self' 'nonce-r4nd0m123'; script-src 'self' 'nonce-r4nd0m123'; connect-src 'self' https://api.aladhan.com; base-uri 'none'; form-action 'self'; frame-ancestors 'none'; upgrade-insecure-requests">
  <meta http-equiv="Referrer-Policy" content="no-referrer">
  <meta http-equiv="Permissions-Policy" content="geolocation=()">
  <meta name="color-scheme" content="light">

  <style nonce="r4nd0m123">
    :root{
      --bg-grad-1:#F6FAFF; --bg-grad-2:#FDFEFF;
      --primary:#2B7A78; --primary-50:#D7EFEE; --primary-20:#EFF9F8;
      --accent:#6EC1E4; --ink:#1C2333; --ink-2:#5A6371; --card:#ffffff;
      --ring: rgba(43,122,120,.25);
      --good:#0ea5e9; --warn:#f59e0b;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family: system-ui, -apple-system, "Segoe UI", "Noto Naskh Arabic", "Cairo", "IBM Plex Sans Arabic", sans-serif;
      color:var(--ink);
      background: linear-gradient(180deg,var(--bg-grad-1),var(--bg-grad-2));
    }
    a{color:var(--primary); text-decoration:none}
    a:hover{text-decoration:underline}
    .container{max-width:1100px; margin:0 auto; padding:1.2rem}
    header{
      background: linear-gradient(90deg, var(--primary-20), #fff);
      border-bottom:1px solid #e6eef2;
      position:sticky; top:0; z-index:10;
    }
    .head{
      display:flex; align-items:center; gap:1rem; justify-content:space-between;
      padding:.6rem 0;
    }
    .brand{display:flex; align-items:center; gap:.8rem}
    .logo{
      width:40px; height:40px; border-radius:12px;
      background: radial-gradient(circle at 30% 30%, var(--accent), var(--primary));
      box-shadow: 0 4px 14px rgba(0,0,0,.1);
    }
    .title{margin:0; font-size:1.25rem}
    .datetimes{
      display:flex; align-items:center; gap:1.2rem; color:var(--ink-2); font-size:.95rem;
    }
    .pill{background:var(--primary-20); padding:.3rem .6rem; border-radius:999px}
    .times-widget{
      display:flex; align-items:center; gap:.6rem; font-size:.9rem;
      color:var(--ink-2);
    }
    .times-widget small{opacity:.9}
    .times-grid{
      display:grid; grid-template-columns:repeat(6, auto); gap:.5rem; align-items:center;
      background:#fff; padding:.4rem .6rem; border-radius:12px; border:1px solid #e8eef3;
    }
    .badge{
      background:var(--primary-50); color:var(--ink);
      padding:.2rem .5rem; border-radius:999px; font-weight:600; font-size:.8rem;
    }
    .current{outline: 2px solid var(--good); background:#e0f2fe}
    main{display:flex; gap:1.2rem; min-height:calc(100vh - 120px)}
    /* الشريط الجانبي الأيمن (الأزرار على اليمين) */
    .side-actions{
      position:sticky; top:88px; align-self:flex-start;
      display:flex; flex-direction:column; gap:.6rem;
      width:180px;
    }
    .action{
      display:block; background:var(--card); border:1px solid #e8eef3;
      border-radius:14px; padding:.7rem .9rem; text-align:center; font-weight:700;
      box-shadow:0 4px 16px rgba(0,0,0,.04);
      transition:transform .15s ease, box-shadow .15s ease;
    }
    .action:hover{transform:translateY(-2px); box-shadow:0 6px 18px rgba(0,0,0,.08)}
    /* المحتوى */
    .content{flex:1}
    section{
      background:var(--card); border:1px solid #e8eef3; border-radius:18px;
      padding:1rem; margin-bottom:1rem; box-shadow:0 8px 24px rgba(0,0,0,.05);
    }
    section h2{margin-top:.2rem}
    .cards{display:grid; grid-template-columns:repeat(2,1fr); gap:.8rem}
    .card{border:1px solid #edf2f6; border-radius:14px; padding:.9rem; background:#fff}
    .card h3{margin:.2rem 0 .4rem 0; font-size:1rem}
    .tip{background:#f8fbff; border:1px dashed #d7e7f6; padding:.6rem; border-radius:10px; color:#224}
    .source{font-size:.85rem; color:var(--ink-2)}
    /* الفوتر */
    footer{
      margin-top:1rem; padding:1rem 0; color:var(--ink-2); font-size:.92rem
    }
    .src-list{display:grid; grid-template-columns:repeat(2,1fr); gap:.5rem}
    /* تجاوب */
    @media (max-width: 980px){
      .times-grid{grid-template-columns:repeat(3, auto)}
      .cards{grid-template-columns:1fr}
      main{flex-direction:column}
      .side-actions{position:static; width:auto; flex-direction:row; overflow:auto}
      .action{white-space:nowrap; flex:1}
    }
  </style>
</head>
<body>
<header>
  <div class="container head" role="banner" aria-label="ترويسة الموقع">
    <div class="brand">
      <div class="logo" aria-hidden="true"></div>
      <h1 class="title">تعليم الصلاة وفق المذهب الجعفري</h1>
    </div>

    <div class="datetimes" aria-live="polite">
      <div class="pill" id="gregorian">التاريخ الميلادي: ...</div>
      <div class="pill" id="hijri">التاريخ الهجري: ...</div>
      <div class="times-widget" title="مواقيت الصلاة (البحرين)">
        <small>مواقيت اليوم – البحرين (جعفري)</small>
        <div class="times-grid" id="timesGrid" aria-label="مواقيت الصلاة الصغيرة">
          <!-- يتم ملؤها برمجياً -->
        </div>
      </div>
    </div>
  </div>
</header>

<div class="container">
  <main>
    <!-- الشريط الجانبي الأيمن -->
    <aside class="side-actions" aria-label="أزرار التصفّح السريعة">
      <a class="action" href="#start">ابدأ التعلّم</a>
      <a class="action" href="#purity">الطهارة</a>
      <a class="action" href="#wudu">الوضوء</a>
      <a class="action" href="#prayers">الصلوات اليومية</a>
      <a class="action" href="#mistakes">مبطلات وأخطاء</a>
      <a class="action" href="#faq">الأسئلة الشائعة</a>
      <a class="action" href="#sources">المراجع</a>
    </aside>

    <!-- المحتوى -->
    <div class="content">
      <section id="start" tabindex="-1">
        <h2>مسار تعلّم أكاديمي مبسّط</h2>
        <p>هذه المنصّة التعليمية تشرح الصلاة وفق المذهب الجعفري بأسلوب واضح وتدريجي، مع الاعتماد على <strong>الموقع الرسمي لمكتب سماحة السيد علي السيستاني</strong> للمسائل الفقهية. بعد كل وحدة تعليمية تجد بطاقة “تحقّق فهم” قصيرة.</p>
      </section>

      <section id="purity" tabindex="-1">
        <h2>الطهارة: المدخل الأول للصلاة</h2>
        <div class="cards">
          <div class="card">
            <h3>النية وآداب الطهارة</h3>
            <p>تُشرع النية والإخلاص لله تعالى، والتحفّظ على طهارة الماء والمكان والبدن.</p>
            <div class="tip">تلميح: راجع فقرات كتاب الطهارة في “منهاج الصالحين”.</div>
            <div class="source">المصدر: <a href="https://www.sistani.org/arabic/book/23720" target="_blank" rel="noopener">منهاج الصالحين – كتاب الطهارة</a></div>
          </div>
          <div class="card">
            <h3>أنواع الطهارة</h3>
            <ul>
              <li><strong>الوضوء</strong> للصلاة ونحوها.</li>
              <li><strong>الغُسل</strong> بأنواعه (ومنها غسل الجنابة).</li>
              <li><strong>التيمم</strong> عند تعذّر الماء أو تعسّره.</li>
            </ul>
            <div class="source">المصدر: <a href="https://www.sistani.org/arabic/book/23720/3619/" target="_blank" rel="noopener">غايات الوضوء</a></div>
          </div>
        </div>
      </section>

      <section id="wudu" tabindex="-1">
        <h2>الوضوء (الواجبات بإيجاز)</h2>
        <div class="cards">
          <div class="card">
            <h3>أجزاء الوضوء</h3>
            <ol>
              <li>غَسل الوجه.</li>
              <li>غَسل اليد اليمنى ثم اليسرى من <em>المِرفق إلى أطراف الأصابع</em>.</li>
              <li>مسح مقدّم الرأس بالرطوبة الباقية.</li>
              <li>مسح ظاهر القدمين بالرطوبة الباقية.</li>
            </ol>
            <div class="source">المصدر: <a href="https://www.sistani.org/arabic/book/23720/4782/" target="_blank" rel="noopener">أجزاء الوضوء</a>، <a href="https://www.sistani.org/arabic/book/22/1691/" target="_blank" rel="noopener">التعليقة على العروة الوثقى – أفعال الوضوء</a></div>
          </div>
          <div class="card">
            <h3>شروط مختصرة</h3>
            <ul>
              <li>طهارة الماء ومباحيته وإطلاقه.</li>
              <li>طهارة أعضاء الوضوء حال الغَسل/المسح.</li>
              <li>الترتيب من الأعلى إلى الأسفل في الغَسل.</li>
            </ul>
            <div class="source">المصدر: <a href="https://www.sistani.org/arabic/book/24/1833/" target="_blank" rel="noopener">الوجيز – الوضوء وشروطه</a>, <a href="https://www.sistani.org/arabic/book/22/1692/" target="_blank" rel="noopener">شرائط الوضوء</a></div>
          </div>
          <div class="card">
            <h3>تذكير عام</h3>
            <p>يُستحب بعض الآداب كالسواك، وغسل اليدين قبل الاغتراف، والمضمضة والاستنشاق.</p>
            <div class="source">المصدر: <a href="https://www.sistani.org/arabic/book/22/1689/" target="_blank" rel="noopener">بعض مستحبات الوضوء</a></div>
          </div>
          <div class="card">
            <h3>متى يجب الوضوء؟</h3>
            <p>للصلوات الواجبة (عدا صلاة الميت)، ولأجزاء الصلاة المنسية حسب التفصيل، وللطواف الواجب…</p>
            <div class="source">المصدر: <a href="https://www.sistani.org/arabic/book/13/528/" target="_blank" rel="noopener">موارد وجوب الوضوء</a></div>
          </div>
        </div>
      </section>

      <section id="prayers" tabindex="-1">
        <h2>الصلوات اليومية (فجر، ظهر، عصر، مغرب، عشاء)</h2>
        <div class="cards">
          <div class="card">
            <h3>الخطوات العامة</h3>
            <ul>
              <li>النية → تكبيرة الإحرام → القراءة → الركوع → السجودان → التشهّد/التسليم بحسب الركعات.</li>
              <li>تذكير: الأذان والإقامة مستحبان مؤكدان.</li>
            </ul>
            <div class="source">المصدر: <a href="https://www.sistani.org/arabic/book/23720" target="_blank" rel="noopener">منهاج الصالحين – كتاب الصلاة</a></div>
          </div>
          <div class="card">
            <h3>تحقّق فهم (قصير)</h3>
            <p>بعد تعلّمك أركان الصلاة، أجب لنفسك: ماذا تبطل به الصلاة؟ كيف تعالج الشك؟</p>
            <div class="source">المصدر: <a href="https://www.sistani.org/arabic/book/22/1679/" target="_blank" rel="noopener">الصلاة في النجس</a>، <a href="https://www.sistani.org/english/book/48/2247/" target="_blank" rel="noopener">مبطلات الصلاة (EN)</a></div>
          </div>
        </div>
      </section>

      <section id="mistakes" tabindex="-1">
        <h2>مبطلات وأخطاء شائعة</h2>
        <div class="card">
          <ul>
            <li>انتقاض الطهارة أثناء الصلاة.</li>
            <li>الإخلال بالترتيب أو الأذكار الواجبة.</li>
            <li>الجهل بالنجاسة على البدن/الثوب له تفاصيل خاصة.</li>
          </ul>
          <div class="source">المصدر: <a href="https://www.sistani.org/english/book/48/2247/" target="_blank" rel="noopener">مبطلات الصلاة</a>, <a href="https://www.sistani.org/arabic/book/22/1679/" target="_blank" rel="noopener">تفصيلات فقهية</a></div>
        </div>
      </section>

      <section id="faq" tabindex="-1">
        <h2>الأسئلة الشائعة</h2>
        <details class="card">
          <summary><strong>هل يجب الوضوء لغسل الجنابة؟</strong></summary>
          <p>لا يجب الوضوء مع غسل الجنابة بل لا يشرع، بخلاف سائر الأغسال.</p>
          <div class="source">المصدر: <a href="https://www.sistani.org/arabic/book/22/1700/" target="_blank" rel="noopener">كيفية الغُسل وأحكامه</a></div>
        </details>
        <details class="card">
          <summary><strong>ماذا أفعل لو شككت في الطهارة؟</strong></summary>
          <p>من تيقّن الطهارة وشكّ في الحدث بنى على الطهارة، والعكس بالعكس، مع تفاصيل في الكتب.</p>
          <div class="source">المصدر: <a href="https://www.sistani.org/arabic/book/23720/3616/" target="_blank" rel="noopener">أحكام الخلل</a></div>
        </details>
      </section>

      <section id="sources" tabindex="-1">
        <h2>المراجع (مكتب السيد السيستاني)</h2>
        <p>هذه الروابط مرجعية للاطلاع والتثبّت، ويُرجى الرجوع إليها عند الحاجة لتفاصيل المسائل:</p>
        <div class="src-list">
          <a href="https://www.sistani.org/arabic/book/23720/4782/" target="_blank" rel="noopener">أجزاء الوضوء – منهاج الصالحين</a>
          <a href="https://www.sistani.org/arabic/book/22/1691/" target="_blank" rel="noopener">أفعال الوضوء – التعليقة</a>
          <a href="https://www.sistani.org/arabic/book/13/528/" target="_blank" rel="noopener">موارد وجوب الوضوء</a>
          <a href="https://www.sistani.org/arabic/book/22/1692/" target="_blank" rel="noopener">شرائط الوضوء – التعليقة</a>
          <a href="https://www.sistani.org/arabic/book/22/1700/" target="_blank" rel="noopener">كيفية الغُسل</a>
          <a href="https://www.sistani.org/english/book/48/2247/" target="_blank" rel="noopener">مبطلات الصلاة (EN)</a>
          <a href="https://www.sistani.org/arabic/book/23720" target="_blank" rel="noopener">منهاج الصالحين – فهرس</a>
        </div>
        <p class="tip" style="margin-top:.8rem">تنبيه: الموقع للتعلّم والإرشاد، والمرجع النهائي: مكتب سماحة السيد السيستاني دام ظله.</p>
      </section>

      <footer>
        <div>© <span id="year"></span> — تعليم الصلاة وفق المذهب الجعفري — تنفيذ واجهة وتعليم تفاعلي.</div>
      </footer>
    </div>
  </main>
</div>

<script nonce="r4nd0m123">
(function(){
  // إعدادات عامة
  const tz = "Asia/Bahrain"; // البحرين UTC+3 بلا توقيت صيفي
  const els = {
    g: document.getElementById('gregorian'),
    h: document.getElementById('hijri'),
    timesGrid: document.getElementById('timesGrid'),
    year: document.getElementById('year')
  };
  els.year.textContent = new Date().getFullYear();

  // تمرير سلس للروابط
  document.querySelectorAll('a[href^="#"]').forEach(a=>{
    a.addEventListener('click', e=>{
      const id = a.getAttribute('href').slice(1);
      const el = document.getElementById(id);
      if(el){ e.preventDefault(); el.scrollIntoView({behavior:'smooth', block:'start'}) }
    });
  });

  // جلب المواقيت عبر AlAdhan (طريقة: 0 = Jafari – Ithna Ashari)
  const city = "Manama";
  const url = `https://api.aladhan.com/v1/timingsByCity?city=${encodeURIComponent(city)}&country=Bahrain&method=0&iso8601=true&timezonestring=${encodeURIComponent(tz)}`;

  fetch(url, {cache:'no-store'})
    .then(r=>r.json())
    .then(json=>{
      if(!json || !json.data){ throw new Error('No data'); }
      const data = json.data;
      // التاريخ الميلادي/الهجري
      const g = data.date.readable; // e.g. 26 Aug 2025
      const h = `${data.date.hijri.day} ${data.date.hijri.month.ar} ${data.date.hijri.year} هـ`;
      els.g.textContent = `التاريخ الميلادي: ${g}`;
      els.h.textContent = `التاريخ الهجري: ${h}`;

      // المواقيت (صغير ومنسّق)
      const t = data.timings;
      const order = [
        ["الفجر","Fajr"],
        ["الشروق","Sunrise"],
        ["الظهر","Dhuhr"],
        ["العصر","Asr"],
        ["المغرب","Maghrib"],
        ["العشاء","Isha"]
      ];
      // تحويل "HH:MM" إلى دقائق منذ منتصف الليل لمقارنة الوقت الحالي
      const toMin = s=>{
        const [hh,mm] = s.split(':').map(Number);
        return hh*60+mm;
      };
      const now = new Date();
      const nowMinutes = now.getHours()*60 + now.getMinutes();

      els.timesGrid.innerHTML = '';
      order.forEach(([label,key])=>{
        const v = t[key].split(' ')[0]; // قد يأتي مع (+03)
        const div = document.createElement('div');
        div.className = 'badge';
        div.textContent = `${label}: ${v}`;
        // تمييز الصلاة الحالية تقريبًا
        const minutes = toMin(v);
        if (Math.abs(minutes - nowMinutes) <= 20){ div.classList.add('current'); }
        els.timesGrid.appendChild(div);
      });
    })
    .catch(err=>{
      console.warn('Prayer times fetch failed:', err);
      els.timesGrid.innerHTML = '<small>تعذر تحديث المواقيت الآن.</small>';
      // تواريخ محلية بديلة
      const d = new Date();
      const g = d.toLocaleDateString('ar', {dateStyle:'full'});
      els.g.textContent = `التاريخ الميلادي: ${g}`;
      try{
        const h = new Intl.DateTimeFormat('ar-SA-u-ca-islamic', {day:'numeric',month:'long',year:'numeric'}).format(d);
        els.h.textContent = `التاريخ الهجري: ${h}`;
      }catch(_){
        els.h.textContent = "التاريخ الهجري: —";
      }
    });
})();
</script>
</body>
</html>
